# 只注释代码无法表达的内容

理论与实践之间的差距在实践中比在理论中更为显著——这个观察在注释中也同样适用。从理论上讲，给代码添加注释的一般想法听起来是值得的：为读者提供细节，解释代码的运行过程。有什么比提供帮助更有用呢？然而，在实践中，注释经常变成一种累赘。与任何其他形式的写作一样，写好注释也需要一定的技巧。其中很大一部分技巧就在于知道何时不需要写注释。

当代码形式不正确时，编译器、解释器和其他工具肯定会报错。如果代码在某种程度上存在功能性错误，代码审查、静态分析、测试以及在生产环境中的日常使用将会暴露出大多数错误。但是注释呢？在《程序设计风格的要素》一书中，Kernighan和Plauger指出，如果注释是错误的，那么它的价值就是零（或者是负值）。然而，这样的注释经常在代码库中存在并保存下来，而代码错误绝对不会如此。它们会不断引起分心和误导，对程序员的思维产生潜在但持续的拖累。

那么，对于在代码中没有技术错误但又没有为代码增加任何价值的注释呢？这些注释只是噪音。那些重复代码的注释对读者来说没有任何额外的帮助——在代码中和自然语言中重复一遍并不能使其变得更真实或更有意义。被注释掉的代码并不是可执行代码，因此对于读者或运行时来说它没有任何有用的影响。它也很快变得过时。与版本相关的注释和被注释掉的代码试图解决版本控制和历史的问题。这些问题已经被版本控制工具（远远更有效地）解决了。

在代码库中存在大量噪音注释和错误注释会促使程序员忽略所有注释，要么跳过它们，要么采取积极的措施将它们隐藏起来。程序员是足智多谋的，他们会绕过任何被视为损害的东西：将注释折叠起来；切换颜色方案，使注释和背景颜色相同；使用脚本过滤掉注释。为了避免程序员智慧被错误应用，并减少忽略任何有价值注释的风险，应该将注释视为代码。每个注释都应该为读者增加一些价值，否则它就是无用的，应该被删除或重写。

那么，什么样的注释才有价值呢？注释应该说出代码无法表达的内容。如果一段代码已经能够表达某个意思，那么对这段代码进行解释的注释就是在邀请修改代码结构或编码规范，使代码自己说明问题。而不是通过注释来弥补糟糕的方法或类名称，应该给它们重新命名。而不是对长函数中的某个部分进行注释，应该提取出更小的函数，函数的名称应该能够捕捉到原来部分的意图。尽量通过代码来表达尽可能多的信息。任何在代码中无法表达但你希望完整表达的内容都可以成为有用注释的合理候选。注释应该说出代码无法表达的内容，而不仅仅是代码没有说出的内容。

由[Kevlin Henney](http://programmer.97things.oreilly.com/wiki/index.php/Kevlin_Henney)撰写
