# 不要将你的程序固定在直立位置

我曾经写过一个恶搞的C++小测验，在其中讽刺性地提出了以下异常处理策略：

> 通过大量使用`try...catch`结构在我们的代码库中，我们有时能够防止应用程序中止。我们把结果状态称为“将尸体钉在竖直位置上”。

尽管我很轻率，但我实际上是在总结我在痛苦经历女士膝下得到的教训。

这是我们自己制作的C++库中的基础应用程序类。多年来，它遭受了许多程序员的摧残：没有人的手是干净的。它包含了处理其他所有异常的代码。受到《第22条军规》中的约瑟夫·约瑟里安的启发，我们决定（或者更确切地说是感觉到，因为“决定”这个词似乎比我们构建这个怪物时的思考更多）这个类的实例应该永远存在，或者在尝试时它就死亡。

为此，我们交织了多个异常处理程序。我们混合使用了Windows的结构化异常处理和本地异常处理（还记得C++中的`__try...__except`吗？我也不记得了）。当发生意外情况时，我们尝试再次调用它们，更加努力地传递参数。回顾过去，我喜欢认为，在一个内部`try...catch`处理程序中编写另一个的catch子句时，某种意识渗透到我身上，我可能无意中从良好实践的高速公路上误入了气味芬芳但不卫生的疯狂小巷。然而，这可能是事后的智慧。

不用说，每当基于这个类的应用程序出现问题时，它们就像在码头上的黑手党受害者一样消失了，没有留下任何有用的气泡痕迹来指示到底发生了什么，尽管据说会调用转储例程记录灾难。最终——经过漫长的时间——我们反思了我们所做的事情，并感到羞愧。我们用一个简洁而健壮的报告机制替换了整个混乱。但这是很多次崩溃的原因。

我不会为了这个而打扰你——毕竟再也没有人能像我们一样愚蠢——但最近我与一个自称应该更加明智的学术职位的家伙在网上发生了争论。我们正在讨论远程事务中的Java代码。如果代码失败，他认为，应该*在现场*捕获和阻塞异常（“然后拿它*做什么*？”我问道。“晚餐可以煮它吗？”）

他引用了用户界面设计师的规则：永远不要让用户看到异常报告，仿佛这解决了问题，因为它是用大写字母写的。我想知道他是否对其中一个蓝屏ATM机的代码负责，这些ATM照片装饰着较弱的博客，并且已经永久性地受到了创伤。无论如何，如果你遇到他，点点头微笑，不要理会他，悄悄靠近门口。

由[Verity Stob](http://programmer.97things.oreilly.com/wiki/index.php/Verity_Stob)撰写
