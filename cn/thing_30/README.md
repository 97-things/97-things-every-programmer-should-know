# 不要重复自己

在所有的编程原则中，不要重复自己(Don't Repeat Yourself, DRY)可能是最基本的原则之一。该原则由Andy Hunt和Dave Thomas在《The Pragmatic Programmer》中提出，它是许多其他众所周知的软件开发最佳实践和设计模式的基础。那些能够识别重复代码并通过适当的实践和适当的抽象来消除重复的开发人员，可以生成比那些不断在应用程序中添加不必要的重复代码的开发人员更清晰的代码。

重复是浪费
---

每一行代码都需要维护，并且是未来错误的潜在来源。重复不必要地膨胀了代码库，增加了出现错误的机会，并给系统添加了意外的复杂性。重复引入的膨胀还使得与系统一起工作的开发人员更难以完全理解整个系统，或者确保在他们正在处理的逻辑的其他重复位置中所做的更改不需要在其他位置中也进行。DRY要求“系统中的每个知识片段必须具有单一、明确、权威的表示”。

流程中的重复需要自动化
---

软件开发中的许多过程是重复的，很容易自动化。DRY原则适用于这些上下文中，就像适用于应用程序源代码一样。手动测试是缓慢、容易出错且难以重复的，因此应尽可能使用自动化测试套件。如果手动进行软件集成，可能会耗费时间且容易出错，因此应尽可能经常运行构建过程，最好是在每次提交时运行。无论在哪里存在痛苦的手动流程可以自动化的，都应该自动化和标准化。目标是确保只有一种完成任务的方式，并且尽可能无痛苦。

逻辑中的重复需要抽象
---

逻辑中的重复可以采用多种形式。复制粘贴的*if-then*或*switch-case*逻辑是最容易检测和修复的。许多设计模式的目标是减少或消除应用程序中逻辑的重复。如果一个对象在使用之前通常需要完成几件事情，可以使用抽象工厂或工厂方法来实现。如果一个对象的行为有很多可能的变化，可以使用策略模式而不是大量的*if-then*结构来注入这些行为。事实上，设计模式的制定本身就是为了减少解决常见问题和讨论此类解决方案所需的重复努力。此外，DRY还可以应用于结构，例如数据库模式规范化。

原则问题
---

其他软件原则也与DRY相关。一次且仅有一次原则，仅适用于代码的功能行为，可以被认为是DRY的一个子集。开闭原则表示“软件实体应该对扩展开放，对修改关闭”，只有在遵循DRY原则的情况下才能实现。同样，众所周知的单一职责原则要求一个类只有“一个变化的理由”，依赖于DRY。

当在结构、逻辑、流程和功能方面遵循DRY原则时，它为软件开发人员提供了基本的指导，并有助于创建更简单、更易于维护、更高质量的应用程序。虽然在满足性能或其他要求时可能需要重复（例如数据库中的数据去正规化），但应仅在直接解决实际问题而非想象问题时使用重复。

由[Steve Smith](http://programmer.97things.oreilly.com/wiki/index.php/Steve_Smith)撰写
